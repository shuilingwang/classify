# 邮件分类项目

## 项目简介
本项目实现了一个基于多项式朴素贝叶斯分类器的邮件分类系统，支持两种特征提取方式：高频词特征和TF-IDF加权特征。通过对邮件文本进行分词、特征提取和模型训练，系统可以对未知邮件进行分类（垃圾邮件或普通邮件）。

## 核心功能说明
1. ​**高频词特征提取**：统计邮件中出现频率最高的词汇，构建词频向量。
2. ​**TF-IDF特征提取**：基于TF-IDF算法计算词汇权重，构建特征向量。
3. ​**样本平衡处理**：通过SMOTE算法对不平衡样本进行过采样，缓解类别分布不均问题。
4. ​**特征模式切换**：通过参数化配置，灵活选择高频词特征或TF-IDF特征。

---

## 算法基础
本项目采用多项式朴素贝叶斯分类器，其基于以下假设：
- 特征条件独立性：假设每个特征在给定类别的情况下是独立的。
- 贝叶斯定理：通过计算后验概率 $P(C|X)$ 来预测类别，公式为: $$P(A|B) = \frac{P(B|A)P(A)}{P(B)}$$ , 
  其中, $P(C|X)$ 由特征条件独立性假设简化为各特征条件概率的乘积。

在邮件分类中，邮件文本被表示为特征向量 $X$，类别为 $C$（垃圾邮件或普通邮件）。模型通过训练数据学习 $P(X|C)$ 和 $P(C)$，从而对未知邮件进行分类。

---

## 数据处理流程
1. ​**分词处理**：使用 `jieba` 对邮件文本进行分词，提取词汇。
2. ​**停用词过滤**：通过正则表达式过滤无效字符（如标点符号、数字等）。
3. ​**特征提取**：
   - 高频词特征：统计词频，选择出现次数最多的词汇作为特征。
   - TF-IDF特征：计算词汇的TF-IDF权重，选择权重最高的词汇作为特征。

---

## 特征构建过程
### 高频词特征
- ​**数学表达式**：统计每个词在语料库中的出现频率 $f(w)$，选择频率最高的 $n$ 个词作为特征。
- ​**实现方式**：使用 `Counter` 统计词频，构建词频向量。

### TF-IDF特征
- ​**数学表达式**：
  $$TF(w) = \frac{f(w, d)}{f(d)}, \quad IDF(w) = \log\frac{N}{f(w) + 1}, \quad TF\text{-}IDF(w) = TF(w) \cdot IDF(w)$$
  其中，$f(w, d)$ 是词 $w$ 在文档 $d$ 中的频率，$f(w)$ 是词 $w$ 在语料库中的频率，$N$ 是文档总数。
- ​**实现方式**：使用 `TfidfVectorizer` 计算TF-IDF权重，构建特征向量。

### 特征模式切换方法
通过 `feature_type` 参数选择特征提取方式：
- `high_freq`：高频词特征。
- `tfidf`：TF-IDF特征。

---

## 样本平衡处理
由于垃圾邮件（127条）与普通邮件（24条）的样本量失衡，本项目采用 `imblearn.over_sampling.SMOTE` 进行过采样，生成更多的普通邮件样本，以缓解类别不平衡问题。

---

## 使用方法
1. 将邮件文本文件放置在 `邮件_files/` 目录下，命名为 `1.txt` 到 `151.txt`。
2. 运行主程序：
   ```bash
   python main.py